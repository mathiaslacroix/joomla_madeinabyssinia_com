function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}function _arrayWithHoles(a){if(Array.isArray(a))return a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}(function(a){'use strict';var c=new RegExp(/^#([a-z0-9]{1,2})([a-z0-9]{1,2})([a-z0-9]{1,2})$/i),b=new RegExp(/^rgba?\(([0-9]+)[\D]+([0-9]+)[\D]+([0-9]+)(?:[\D]+([0-9](?:.\d+)?))?\)$/i),d=new RegExp(/^hsla?\(([0-9]+)[\D]+([0-9]+)[\D]+([0-9]+)[\D]+([0-9](?:.\d+)?)?\)$/i),e=new RegExp(/^(([0-1])|(0\\.[0-9]+)|([0-9]{1,2})|(100))$/),f=new RegExp(/^[0-9]{1,3}$/),g=function(){function a(b){var c=this;_classCallCheck(this,a),this.messageSpan=b.querySelector(".form-control-feedback"),this.mainInput=b.querySelector(".color-input"),this.input=b.querySelector("#slider-input"),this.sliders=b.querySelectorAll(".color-slider"),this.hueSlider=b.querySelector("#hue-slider"),this.saturationSlider=b.querySelector("#saturation-slider"),this.lightSlider=b.querySelector("#light-slider"),this.alphaSlider=b.querySelector("#alpha-slider"),this.color=b.dataset.color||"",this.default=b.dataset.default||"",this.format=this.input.dataset.format||"hex",this.saveFormat=this.mainInput.dataset.format||"hex",this.preview="true"===b.dataset.preview,this.setAlpha="hsla"===this.format||"rgba"===this.format,this.hue=360,this.saturation=1,this.light=1,this.alpha=1,this.defaultHsl=[this.hue,this.saturation,this.light,this.alpha],this.setInitValue(),this.setBackground(),this.preview?this.setInputPattern():this.input.style.display="none",this.mainInput.style.display="none",Array.prototype.forEach.call(this.sliders,function(a){a.addEventListener("change",function(){return c.updateValue(a)})}),this.input.addEventListener("change",function(){return c.changeInput(c.input)})}var g=Math.round;return _createClass(a,[{key:"updateValue",value:function updateValue(a){this.showError("");var b=this.getSliderValueAsHsl(a.value,a.dataset.type),c=this.hslToRgb(b),d=_slicedToArray(b,4);this.hue=d[0],this.saturation=d[1],this.light=d[2],this.alpha=d[3],this.input.style.border="2px solid ".concat(this.getRgbString(c)),this.setSliderValues(b,a.dataset.type),this.setInputValue(b),this.setBackground(a)}},{key:"changeInput",value:function changeInput(a){var b=[this.hue,this.saturation,this.light,this.alpha];if(!a.value)return this.mainInput.value="",void this.showError("");if(!this.checkValue(a.value))this.showError("JFIELD_COLOR_ERROR_WRONG_FORMAT"),this.setInputValue(this.defaultHsl);else{switch(this.showError(""),this.format){case"hue":b[0]=a.value,this.hue=a.value;break;case"saturation":b[1]=a.value,this.saturation=a.value;break;case"light":b[2]=a.value,this.light=a.value;break;case"alpha":b[3]=a.value,this.alpha=a.value;break;default:b=this.getHsl(a.value);}this.setSliderValues(b),this.setInputValue(b,!0)}}},{key:"checkValue",value:function checkValue(a,g){var h=g||this.format;return"hue"===h?360>=a&&f.test(a):"saturation"===h||"light"===h||"alpha"===h?e.test(a):"hsl"===h||"hsla"===h?d.test(a):"hex"===h?c.test(a):("rgb"===h||"rgba"===h)&&b.test(a)}},{key:"setInputPattern",value:function setInputPattern(){var a;switch(this.format){case"hue":a=f.source.slice(1,-1);break;case"saturation":case"light":case"alpha":a=e.source.slice(1,-1);break;case"hsl":case"hsla":a=d.source.slice(1,-1);break;case"rgb":a=b.source.slice(1,-1);break;case"hex":default:a=c.source.slice(1,-1);}this.input.setAttribute("pattern",a)}},{key:"setBackground",value:function setBackground(a){var b=this;Array.prototype.forEach.call(this.sliders,function(c){if(a!==c){var d=[],e=100;if(d.push(b.getSliderValueAsRgb(0,c.dataset.type)),"hue"===c.dataset.type){e=360;for(var f=0;360>=f;f+=18)d.push(b.getSliderValueAsRgb(f,c.dataset.type))}else for(var g=0;100>=g;g+=10)d.push(b.getSliderValueAsRgb(g,c.dataset.type));d.push(b.getSliderValueAsRgb(e,c.dataset.type)),d=d.map(function(a){return b.getRgbString(a)}),c.style.background="linear-gradient(90deg, ".concat(d.join(","),")"),c.style.webkitAppearance="none"}})}},{key:"setInitValue",value:function setInitValue(){var a=window.getComputedStyle(this.input).getPropertyValue(this.default);if(this.default=a||this.default,""===this.color||"undefined"==typeof this.color)return this.input.value="",void(this.mainInput.value="");var b=this.checkValue(this.color,this.saveFormat)?this.color:this.default;if(!b)return void this.showError("JFIELD_COLOR_ERROR_NO_COLOUR");var c=[];/^[0-9]+$/.test(b)?(c=this.default&&this.getHsl(this.default),"hue"===this.format&&(c[0]=b),"saturation"===this.format&&(c[1]=1<b?b/100:b),"light"===this.format&&(c[2]=1<b?b/100:b),"alpha"===this.format&&(c[3]=1<b?b/100:b)):c=this.getHsl(b);var d=c,e=_slicedToArray(d,3);this.hue=e[0],this.saturation=e[1],this.light=e[2],this.alpha=c[4]||this.alpha,this.defaultHsl=this.default?this.getHsl(this.default):c,this.setSliderValues(c),this.setInputValue(c),this.input.style.border="2px solid ".concat(this.getRgbString(this.hslToRgb(c)))}},{key:"showError",value:function showError(a){this.messageSpan.innerText=a?Joomla.Text._(a):""}},{key:"getHsl",value:function getHsl(a){var e=[];if(Array.isArray(a))e=a;else if(c.test(a))e=this.hexToHsl(a);else if(b.test(a))e=this.rgbToHsl(a);else if(d.test(a)){var g=a.match(d);e=[g[1],g[2],g[3],g[4]]}else return this.showError("JFIELD_COLOR_ERROR_CONVERT_HSL"),this.defaultHsl;var f;for(f=1;f<e.length;f+=1)e[f]=1<e[f]?e[f]/100:e[f];return e}},{key:"getSliderValueAsHsl",value:function getSliderValueAsHsl(b,c){var d=this.hue,e=this.saturation,f=this.light,g=this.alpha;switch(c){case"alpha":g=b;break;case"saturation":e=b;break;case"light":f=b;break;case"hue":default:d=b;}return 1<f&&(f/=100),1<e&&(e/=100),1<g&&(g/=100),[d,e,f,g]}},{key:"getSliderValueAsRgb",value:function getSliderValueAsRgb(a,b){return this.hslToRgb(this.getSliderValueAsHsl(a,b))}},{key:"setSliderValues",value:function setSliderValues(b,c){var d=_slicedToArray(b,4),e=d[0],f=d[1],h=d[2],i=d[3];this.hueSlider&&"hue"!==c&&(this.hueSlider.value=g(e)),this.saturationSlider&&"saturation"!==c&&(this.saturationSlider.value=g(100*f)),this.lightSlider&&"light"!==c&&(this.lightSlider.value=g(100*h)),i&&this.alphaSlider&&"alpha"!==c&&(this.alphaSlider.value=g(100*i))}},{key:"setInputValue",value:function setInputValue(a,b){var c=this,d=[this.mainInput];b||d.push(this.input),d.forEach(function(b){var d;switch(b.dataset.format){case"hsl":d=c.getHslString(a);break;case"hsla":d=c.getHslString(a,!0);break;case"rgb":d=c.getRgbString(c.hslToRgb(a));break;case"rgba":d=c.getRgbString(c.hslToRgb(a),!0);break;case"hex":d=c.rgbToHex(c.hslToRgb(a));break;case"alpha":d=g(100*a[3]);break;case"saturation":d=g(100*a[1]);break;case"light":d=g(100*a[2]);break;case"hue":default:d=g(a[0]);}b.value=d})}},{key:"getRgbString",value:function getRgbString(c,d){var e=_slicedToArray(c,4),f=e[0],h=e[1],g=e[2],b=e[3];if(d||this.setAlpha){var a="undefined"==typeof b?this.alpha:b;return"rgba(".concat(f,", ").concat(h,", ").concat(g,", ").concat(a,")")}return"rgb(".concat(f,", ").concat(h,", ").concat(g,")")}},{key:"getHslString",value:function getHslString(b,c){var d=_slicedToArray(b,4),e=d[0],f=d[1],i=d[2],j=d[3];f*=100,i*=100;var k=[e,f,i].map(function(a){return g(a)}),m=_slicedToArray(k,3);return e=m[0],f=m[1],i=m[2],c||this.setAlpha?(j=j||this.alpha,"hsla(".concat(e,", ").concat(f,"%, ").concat(i,"%, ").concat(j,")")):"hsl(".concat(e,", ").concat(f,"%, ").concat(i,"%)")}},{key:"rgbToHex",value:function rgbToHex(a){var c=a[0].toString(16).toUpperCase(),d=a[1].toString(16).toUpperCase(),e=a[2].toString(16).toUpperCase();return c=1===c.length?"".concat(c).concat(c):c,d=1===d.length?"".concat(d).concat(d):d,e=1===e.length?"".concat(e).concat(e):e,"#".concat(c).concat(d).concat(e)}},{key:"rgbToHsl",value:function rgbToHsl(c){var e=Math.min,f=c;if("string"==typeof c){var t=c.match(b);f=[t[1],t[2],t[3],t[4]]}var i=f.map(function(a){return 1<a?a/255:a}),j=_slicedToArray(i,3),k=j[0],m=j[1],g=j[2],n=Math.max(k,m,g),o=e(k,m,g),p=(n+o)/2,l=n-o,d=0,q=0,r=f[3]||c[3]||this.alpha;if(n!==o)switch(q=0===n?n:1===o?o:(n-p)/e(p,1-p),n){case k:d=60*(m-g)/l;break;case m:d=60*(2+(g-k)/l);break;case g:default:d=60*(4+(k-m)/l);}return d=0>d?d+360:d,r=1<r?r/100:r,[d,q,p,r]}},{key:"hexToHsl",value:function hexToHsl(a){var d=a.match(c),e=d[1],f=d[2],g=d[3],b=[parseInt(e,16),parseInt(f,16),parseInt(g,16)];return this.rgbToHsl(b)}},{key:"hslToRgb",value:function hslToRgb(d){var e=Math.abs,f=_slicedToArray(d,4),i=f[0],h=f[1],j=f[2],k=f[3],m=1,n=1,o=1,p=1<h?h/100:h,q=1<j?j/100:j,l=1<k?k/100:k;if(0>i||360<i||0>p||1<p||0>q||1<q)return this.showError("JFIELD_COLOR_ERROR_CONVERT_HSL"),this.hslToRgb(this.defaultHsl);var a=(1-e(2*q-1))*p,c=a*(1-e(i/60%2-1));if(0<=i&&60>i)m=a,n=c,o=0;else if(60<=i&&120>i)m=c,n=a,o=0;else if(120<=i&&180>i)m=0,n=a,o=c;else if(180<=i&&240>i)m=0,n=c,o=a;else if(240<=i&&300>i)m=c,n=0,o=a;else if(300<=i&&360>=i)m=a,n=0,o=c;else return this.showError("JFIELD_COLOR_ERROR_CONVERT_HUE"),this.hslToRgb(this.defaultHsl);var s=[m,n,o].map(function(b){return g(255*(b+(q-a/2)))});return s.push(l),s}}]),a}();a.addEventListener("DOMContentLoaded",function(){var b=a.querySelectorAll(".color-slider-wrapper");b&&Array.prototype.forEach.call(b,function(a){new g(a)})})})(document);